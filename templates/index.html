<!DOCTYPE html>
<html>
<head>
    <title>Word Fantasy</title>
    <style>
        body {
            background: black;
            color: white;
            font-family: Arial;
            text-align: center;
        }

        #game-image {
            width: 400px;
            margin: 20px auto;
        }

        #text-box {
            background: #111;
            padding: 20px;
            margin: 20px auto;
            width: 60%;
            border: 1px solid red;
        }

        button {
            padding: 10px 20px;
            margin: 10px;
            background: darkred;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background: red;
        }

        #stats {
            margin-top: 20px;
            border-top: 1px solid gray;
            padding-top: 10px;
        }
    </style>
</head>
<body>

<h1>WORD FANTASY</h1>

<img id="game-image" src="https://i.imgur.com/3ZQ3Z6D.jpg">

<div id="text-box">
    Voc√™ acorda na Floresta Sombria...
</div>

<div id="buttons"></div>

<div id="stats">
    ‚ù§Ô∏è Vida: <span id="hp">100</span> |
    ‚öîÔ∏è Ataque: <span id="atk">10</span> |
    üçÄ Sorte: <span id="luck">5</span>
</div>

<script>
let player = {
    hp: 100,
    atk: 10,
    luck: 5
};

let enemy = {
    hp: 30
};

function updateStats() {
    document.getElementById("hp").innerText = player.hp;
    document.getElementById("atk").innerText = player.atk;
    document.getElementById("luck").innerText = player.luck;
}

function startGame() {
    enemy.hp = 30;

    document.getElementById("text-box").innerText =
        "Um goblin aparece diante de voc√™! HP do Goblin: " + enemy.hp;

    document.getElementById("buttons").innerHTML = `
        <button onclick="attack()">Atacar</button>
        <button onclick="run()">Fugir</button>
    `;
}

async function attack() {

    const response = await fetch("/attack", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            player_hp: player.hp,
            player_atk: player.atk,
            player_luck: player.luck,
            enemy_hp: enemy.hp
        })
    });

    const data = await response.json();

    player.hp = data.player_hp;
    enemy.hp = data.enemy_hp;

    updateStats();

    let message = "Voc√™ causou " + data.damage + " de dano.";

    if (data.critical) {
        message += " üí• CR√çTICO!";
    }

    if (enemy.hp <= 0) {
        message += " O goblin morreu!";
        document.getElementById("buttons").innerHTML =
            `<button onclick="startGame()">Explorar novamente</button>`;
    } else if (player.hp <= 0) {
        message += " O goblin contra-atacou e voc√™ morreu!";
        document.getElementById("buttons").innerHTML =
            `<button onclick="restartGame()">Recome√ßar</button>`;
    } else {
        message += " O goblin causou " + data.enemy_damage + " de dano.";
        message += " HP do Goblin: " + enemy.hp;
    }

    document.getElementById("text-box").innerText = message;
}

    async function attack() {

    const response = await fetch("/attack", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            player_hp: player.hp,
            player_atk: player.atk,
            player_luck: player.luck,
            enemy_hp: enemy.hp
        })
    });

    const data = await response.json();

    player.hp = data.player_hp;
    enemy.hp = data.enemy_hp;

    updateStats();

    let message = "Voc√™ causou " + data.damage + " de dano.";

    if (data.critical) {
        message += " üí• CR√çTICO!";
    }

    if (enemy.hp <= 0) {
        message += " O goblin morreu!";
        document.getElementById("buttons").innerHTML =
            `<button onclick="startGame()">Explorar novamente</button>`;
    } else if (player.hp <= 0) {
        message += " O goblin contra-atacou e voc√™ morreu!";
        document.getElementById("buttons").innerHTML =
            `<button onclick="restartGame()">Recome√ßar</button>`;
    } else {
        message += " O goblin causou " + data.enemy_damage + " de dano.";
        message += " HP do Goblin: " + enemy.hp;
    }

    document.getElementById("text-box").innerText = message;
}
